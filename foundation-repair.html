<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Texas Foundation Repair Estimator</title>
    <style>
        body {
            background-color: #f5f7fb; /* Light gray-blue */
            margin: 0;
            padding: 1rem;
            box-sizing: border-box;
            font-family: 'Poppins', -apple-system, BlinkMacSystemFont, sans-serif;
            min-height: 100vh;
            -webkit-text-size-adjust: 100%; /* Prevent iOS zoom */
        }
        .container {
            max-width: 90%;
            width: min(900px, 100%);
            margin: 0 auto;
            background: #ffffff;
            padding: 1.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #1e3a8a; /* Deep blue */
            font-size: clamp(1.5rem, 5vw, 1.8rem);
            margin: 0 0 0.5rem;
        }
        h2 {
            color: #1e3a8a;
            font-size: clamp(1.2rem, 4vw, 1.5rem);
            margin: 0 0 1rem;
            text-align: center;
        }
        p {
            color: #4b5563; /* Cool gray */
            text-align: center;
            font-size: clamp(0.9rem, 3vw, 1rem);
            margin: 0 0 0.5rem;
        }
        #inputScreen {
            background-image: url('https://upload.wikimedia.org/wikipedia/commons/thumb/f/f7/Flag_of_Texas.svg/1024px-Flag_of_Texas.svg.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            border-radius: 8px;
            padding: 1rem;
            position: relative;
        }
        #inputScreen::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255, 255, 255, 0.85);
            border-radius: 8px;
            z-index: 1;
        }
        #inputScreen > * {
            position: relative;
            z-index: 2;
        }
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }
        label {
            color: #1e40af; /* Bright blue */
            font-weight: 500;
            font-size: clamp(0.9rem, 2.5vw, 1rem);
            display: block;
            margin-bottom: 0.3rem;
        }
        select, input[type="number"] {
            width: 100%;
            padding: 0.6rem;
            border: 1px solid #d1d5db; /* Light gray */
            border-radius: 6px;
            font-size: clamp(0.9rem, 2.5vw, 1rem);
            color: #1f2937; /* Dark gray */
            background: #f9fafb;
            transition: border-color 0.3s ease;
            box-sizing: border-box;
            touch-action: manipulation; /* Smooth touch */
        }
        select:focus, input[type="number"]:focus {
            outline: none;
            border-color: #3b82f6; /* Bright blue */
        }
        input[type="number"]::placeholder {
            color: #9ca3af; /* Muted gray */
        }
        .optional {
            grid-column: span 2;
        }
        .checkbox-group {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        input[type="checkbox"] {
            accent-color: #3b82f6;
            margin-right: 0.3rem;
        }
        .button-group {
            grid-column: span 2;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        .button-row {
            display: flex;
            gap: 1rem;
            justify-content: center;
        }
        button {
            padding: 0.8rem 1.5rem;
            background: #db2777; /* Coral pink */
            color: #ffffff;
            border: none;
            border-radius: 6px;
            font-size: clamp(1rem, 3vw, 1.1rem);
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.2s ease;
            touch-action: manipulation;
        }
        button:hover {
            background: #be185d;
            transform: translateY(-2px);
        }
        #adminBtn {
            background: #1e3a8a; /* Deep blue */
        }
        #adminBtn:hover {
            background: #1e40af;
        }
        .copyright {
            color: #4b5563; /* Dark gray */
            font-size: 0.9rem;
            text-align: center;
        }
        .info-box-container {
            height: 4.5rem; /* Fixed height for info box */
            margin: 0.5rem 0;
        }
        #infoBox {
            background: #eff6ff; /* Light blue */
            color: #1f2937;
            padding: 0.8rem;
            border-radius: 6px;
            border: 1px solid #d1d5db;
            font-size: 0.9rem;
            line-height: 1.4;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
            max-height: 4.5rem; /* Match container */
            overflow: hidden;
            visibility: hidden; /* Hidden by default */
        }
        #infoBox.active {
            visibility: visible; /* Show when active */
        }
        #summaryScreen, #adminScreen {
            text-align: left;
        }
        #summaryContent, #adminContent {
            background: #eff6ff; /* Light blue */
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            color: #1f2937;
            font-size: clamp(0.9rem, 3vw, 1rem);
            line-height: 1.5;
        }
        #summaryContent p {
            margin: 0.5rem 0;
            text-align: left;
        }
        #summaryContent .total {
            font-weight: 700;
            color: #1e3a8a;
            font-size: clamp(1.1rem, 3.5vw, 1.2rem);
        }
        #summaryContent .disclaimer {
            font-size: clamp(0.8rem, 2.5vw, 0.9rem);
            font-style: italic;
            color: #6b7280;
        }
        #adminContent {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem;
            padding: 0.8rem;
        }
        .admin-section {
            flex: 1;
            min-width: 180px;
            background: #ffffff;
            padding: 0.8rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
        }
        .admin-section h3 {
            color: #1e3a8a;
            font-size: 1rem;
            margin: 0 0 0.5rem;
            text-align: center;
        }
        .admin-section label {
            font-size: 0.85rem;
            margin: 0.2rem 0;
            color: #1f2937;
        }
        .admin-section input[type="number"] {
            margin: 0.2rem 0;
            padding: 0.4rem;
            font-size: 0.85rem;
            border-radius: 4px;
        }
        #returnBtn, #returnBtnAdmin {
            background: #6b7280; /* Neutral gray */
            display: block;
            margin: 0 auto;
        }
        #returnBtn:hover, #returnBtnAdmin:hover {
            background: #4b5563;
        }
        @media (max-width: 600px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            .optional, .button-group {
                grid-column: span 1;
            }
            .button-row {
                flex-direction: column;
                gap: 0.5rem;
                width: 100%;
            }
            button {
                width: 100%;
            }
            .info-box-container {
                height: 5rem; /* Slightly taller for mobile */
            }
            #infoBox {
                font-size: 0.8rem;
                max-height: 5rem;
            }
            #adminContent {
                flex-direction: column;
                gap: 1rem;
            }
            .admin-section {
                min-width: 100%;
            }
            .copyright {
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Texas Foundation Repair Estimator</h1>
        <p id="introText">Estimate piers and costs for your Texas home. Select fields for details below. Based on average pricing.</p>
        <div class="info-box-container">
            <div id="infoBox"></div>
        </div>
        <div id="inputScreen">
            <form id="estimateForm">
                <div class="form-grid">
                    <div>
                        <label for="foundationType">Foundation Type:</label>
                        <select id="foundationType" data-info="Slab: Concrete poured on ground (common in Texas). Crawl Space: Raised with space underneath. Basement: Below-ground (rare in Texas)." required>
                            <option value="">Select</option>
                            <option value="slab">Slab</option>
                            <option value="crawl">Crawl Space</option>
                            <option value="basement">Basement</option>
                        </select>
                    </div>
                    <div>
                        <label for="squareFootage">Square Footage:</label>
                        <input type="number" id="squareFootage" data-info="Your home’s livable area in square feet (e.g., 1,500 sq ft). Check property records if unsure." min="0" required placeholder="e.g., 1500">
                    </div>
                    <div>
                        <label for="repairLocation">Repair Location:</label>
                        <select id="repairLocation" data-info="Perimeter: Exterior walls. Interior: Inside home (e.g., under floors). Both: Perimeter and interior." required>
                            <option value="">Select</option>
                            <option value="perimeter">Perimeter</option>
                            <option value="interior">Interior</option>
                            <option value="both">Both</option>
                        </select>
                    </div>
                    <div>
                        <label for="severity">Severity:</label>
                        <select id="severity" data-info="Light: Minor cracks (<1/4 inch), slight unevenness. Moderate: Wider cracks (1/4-1/2 inch), sloping. Severe: Large cracks (>1/2 inch), major issues." required>
                            <option value="">Select</option>
                            <option value="light">Light</option>
                            <option value="moderate">Moderate</option>
                            <option value="severe">Severe</option>
                        </select>
                    </div>
                    <div>
                        <label for="pierType">Pier Type:</label>
                        <select id="pierType" data-info="Concrete: Pressed pilings, cost-effective. Steel: Stronger, deeper. Helical: Screw-like for unstable soils." required>
                            <option value="">Select</option>
                            <option value="concrete">Concrete</option>
                            <option value="steel">Steel</option>
                            <option value="helical">Helical</option>
                        </select>
                    </div>
                    <div>
                        <label for="depth">Pier Depth:</label>
                        <select id="depth" data-info="Shallow: Up to 10 ft, stable soils. Medium: 10-20 ft, typical Texas clay. Deep: Over 20 ft, unstable soils." required>
                            <option value="">Select</option>
                            <option value="shallow">Shallow</option>
                            <option value="medium">Medium</option>
                            <option value="deep">Deep</option>
                        </select>
                    </div>
                    <div>
                        <label for="access">Access Difficulty:</label>
                        <select id="access" data-info="Easy: Clear access. Moderate: Some obstacles (e.g., landscaping). Difficult: Major obstructions (e.g., tight spaces)." required>
                            <option value="">Select</option>
                            <option value="easy">Easy</option>
                            <option value="moderate">Moderate</option>
                            <option value="difficult">Difficult</option>
                        </select>
                    </div>
                    <div class="optional">
                        <label for="permits">Optional Costs:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" id="permits"> Permits</label>
                            <label><input type="checkbox" id="additional"> Additional Repairs</label>
                        </div>
                    </div>
                    <div class="button-group">
                        <div class="button-row">
                            <button type="button" id="calculateBtn">Calculate</button>
                            <button type="button" id="adminBtn">Admin</button>
                        </div>
                        <div class="copyright">© P Bristow 2025</div>
                    </div>
                </div>
            </form>
        </div>
        <div id="summaryScreen" style="display:none;">
            <h2>Your Estimate Summary</h2>
            <div id="summaryContent"></div>
            <button id="returnBtn">Return to Input</button>
        </div>
        <div id="adminScreen" style="display:none;">
            <h2>Admin: Edit Assumptions</h2>
            <div id="adminContent">
                <div class="admin-section">
                    <h3>Pricing</h3>
                    <label for="pierCostConcrete">Concrete ($):</label>
                    <input type="number" id="pierCostConcrete" min="0" step="1" value="1100">
                    <label for="pierCostSteel">Steel ($):</label>
                    <input type="number" id="pierCostSteel" min="0" step="1" value="1400">
                    <label for="pierCostHelical">Helical ($):</label>
                    <input type="number" id="pierCostHelical" min="0" step="1" value="2000">
                    <label for="permitCost">Permits ($):</label>
                    <input type="number" id="permitCost" min="0" step="1" value="500">
                    <label for="additionalCost">Repairs ($):</label>
                    <input type="number" id="additionalCost" min="0" step="1" value="1500">
                </div>
                <div class="admin-section">
                    <h3>Depth Multipliers</h3>
                    <label for="depthShallow">Shallow:</label>
                    <input type="number" id="depthShallow" min="0" step="0.01" value="1.0">
                    <label for="depthMedium">Medium:</label>
                    <input type="number" id="depthMedium" min="0" step="0.01" value="1.15">
                    <label for="depthDeep">Deep:</label>
                    <input type="number" id="depthDeep" min="0" step="0.01" value="1.4">
                </div>
                <div class="admin-section">
                    <h3>Access Multipliers</h3>
                    <label for="accessEasy">Easy:</label>
                    <input type="number" id="accessEasy" min="0" step="0.01" value="1.0">
                    <label for="accessModerate">Moderate:</label>
                    <input type="number" id="accessModerate" min="0" step="0.01" value="1.1">
                    <label for="accessDifficult">Difficult:</label>
                    <input type="number" id="accessDifficult" min="0" step="0.01" value="1.25">
                </div>
                <div class="admin-section">
                    <h3>Placement</h3>
                    <label for="slabPerimeterSpacing">Slab Perimeter (ft):</label>
                    <input type="number" id="slabPerimeterSpacing" min="1" step="0.1" value="6">
                    <label for="slabInteriorDensity">Slab Interior (sq ft):</label>
                    <input type="number" id="slabInteriorDensity" min="1" step="1" value="100">
                    <label for="slabBothInteriorDensity">Slab Both (sq ft):</label>
                    <input type="number" id="slabBothInteriorDensity" min="1" step="1" value="200">
                    <label for="crawlBasementDensity">Crawl/Basement (sq ft):</label>
                    <input type="number" id="crawlBasementDensity" min="1" step="1" value="150">
                </div>
                <div class="admin-section">
                    <h3>Severity Multipliers</h3>
                    <label for="severityLight">Light:</label>
                    <input type="number" id="severityLight" min="0" step="0.01" value="1.0">
                    <label for="severityModerate">Moderate:</label>
                    <input type="number" id="severityModerate" min="0" step="0.01" value="1.5">
                    <label for="severitySevere">Severe:</label>
                    <input type="number" id="severitySevere" min="0" step="0.01" value="2.0">
                </div>
            </div>
            <button id="returnBtnAdmin">Return to Input</button>
        </div>
    </div>

    <script>
        // Store assumptions globally
        let assumptions = {
            pierCosts: { concrete: 1100, steel: 1400, helical: 2000 },
            permitCost: 500,
            additionalCost: 1500,
            depthMultipliers: { shallow: 1.0, medium: 1.15, deep: 1.4 },
            accessMultipliers: { easy: 1.0, moderate: 1.1, difficult: 1.25 },
            slabPerimeterSpacing: 6,
            slabInteriorDensity: 100,
            slabBothInteriorDensity: 200,
            crawlBasementDensity: 150,
            severityMultipliers: { light: 1.0, moderate: 1.5, severe: 2.0 }
        };

        function calculateEstimate() {
            const foundationType = document.getElementById('foundationType').value;
            const squareFootage = parseFloat(document.getElementById('squareFootage').value);
            const repairLocation = document.getElementById('repairLocation').value;
            const severity = document.getElementById('severity').value;
            const pierType = document.getElementById('pierType').value;
            const depth = document.getElementById('depth').value;
            const access = document.getElementById('access').value;
            const includePermits = document.getElementById('permits').checked;
            const includeAdditional = document.getElementById('additional').checked;

            if (!foundationType || isNaN(squareFootage) || squareFootage <= 0 || !repairLocation || !severity || !pierType || !depth || !access) {
                alert('Please fill in all fields correctly.');
                return;
            }

            const perimeter = 4 * Math.sqrt(squareFootage);
            let baseNumberOfPiers;
            if (foundationType === 'slab') {
                if (repairLocation === 'perimeter') {
                    baseNumberOfPiers = perimeter / assumptions.slabPerimeterSpacing;
                } else if (repairLocation === 'interior') {
                    baseNumberOfPiers = squareFootage / assumptions.slabInteriorDensity;
                } else {
                    baseNumberOfPiers = (perimeter / assumptions.slabPerimeterSpacing) + (squareFootage / assumptions.slabBothInteriorDensity);
                }
            } else {
                baseNumberOfPiers = squareFootage / assumptions.crawlBasementDensity;
            }

            const severityMultiplier = assumptions.severityMultipliers[severity];
            const adjustedNumberOfPiers = baseNumberOfPiers * severityMultiplier;
            const estimatedPiers = Math.round(adjustedNumberOfPiers);

            const baseCostPerPier = assumptions.pierCosts[pierType];
            const depthMultiplier = assumptions.depthMultipliers[depth];
            let adjustedCostPerPier = baseCostPerPier * depthMultiplier;
            let pierCost = estimatedPiers * adjustedCostPerPier;

            const accessMultiplier = assumptions.accessMultipliers[access];
            pierCost *= accessMultiplier;

            const permitCost = includePermits ? assumptions.permitCost : 0;
            const additionalCost = includeAdditional ? assumptions.additionalCost : 0;
            const totalCost = Math.round(pierCost + permitCost + additionalCost);

            const foundationLabels = { slab: 'Slab', crawl: 'Crawl Space', basement: 'Basement' };
            const locationLabels = { perimeter: 'Perimeter', interior: 'Interior', both: 'Both' };
            const severityLabels = { light: 'Light', moderate: 'Moderate', severe: 'Severe' };
            const pierLabels = { concrete: 'Concrete', steel: 'Steel', helical: 'Helical' };
            const depthLabels = { shallow: 'Shallow', medium: 'Medium', deep: 'Deep' };
            const accessLabels = { easy: 'Easy', moderate: 'Moderate', difficult: 'Difficult' };

            const summary = `
                <p>For your ${squareFootage.toLocaleString()} sq ft home with a ${foundationLabels[foundationType].toLowerCase()} foundation, we've estimated the following for your foundation repair:</p>
                <p><strong>Repair Scope</strong>: Addressing ${severityLabels[severity].toLowerCase()} damage at the ${locationLabels[repairLocation].toLowerCase()} of your home.</p>
                <p><strong>Piers</strong>: ${estimatedPiers} ${pierLabels[pierType]} piers at ${depthLabels[depth].toLowerCase()} depth, costing $${pierCost.toLocaleString()} after adjusting for ${accessLabels[access].toLowerCase()} access.</p>
                ${includePermits ? `<p><strong>Permits</strong>: Added $${permitCost.toLocaleString()} for required Texas permits.</p>` : ''}
                ${includeAdditional ? `<p><strong>Additional Repairs</strong>: Included $${additionalCost.toLocaleString()} for cosmetic or drainage fixes.</p>` : ''}
                <p class="total">Total Estimated Cost: $${totalCost.toLocaleString()}</p>
                <p class="disclaimer">*Based on average Texas residential pricing. Consult a professional for an accurate quote.</p>
            `;

            document.getElementById('summaryContent').innerHTML = summary;
            document.getElementById('inputScreen').style.display = 'none';
            document.getElementById('summaryScreen').style.display = 'block';
        }

        function showAdminScreen() {
            document.getElementById('pierCostConcrete').value = assumptions.pierCosts.concrete;
            document.getElementById('pierCostSteel').value = assumptions.pierCosts.steel;
            document.getElementById('pierCostHelical').value = assumptions.pierCosts.helical;
            document.getElementById('permitCost').value = assumptions.permitCost;
            document.getElementById('additionalCost').value = assumptions.additionalCost;
            document.getElementById('depthShallow').value = assumptions.depthMultipliers.shallow;
            document.getElementById('depthMedium').value = assumptions.depthMultipliers.medium;
            document.getElementById('depthDeep').value = assumptions.depthMultipliers.deep;
            document.getElementById('accessEasy').value = assumptions.accessMultipliers.easy;
            document.getElementById('accessModerate').value = assumptions.accessMultipliers.moderate;
            document.getElementById('accessDifficult').value = assumptions.accessMultipliers.difficult;
            document.getElementById('slabPerimeterSpacing').value = assumptions.slabPerimeterSpacing;
            document.getElementById('slabInteriorDensity').value = assumptions.slabInteriorDensity;
            document.getElementById('slabBothInteriorDensity').value = assumptions.slabBothInteriorDensity;
            document.getElementById('crawlBasementDensity').value = assumptions.crawlBasementDensity;
            document.getElementById('severityLight').value = assumptions.severityMultipliers.light;
            document.getElementById('severityModerate').value = assumptions.severityMultipliers.moderate;
            document.getElementById('severitySevere').value = assumptions.severityMultipliers.severe;

            document.getElementById('inputScreen').style.display = 'none';
            document.getElementById('adminScreen').style.display = 'block';
        }

        function updateAssumptions() {
            assumptions.pierCosts.concrete = parseFloat(document.getElementById('pierCostConcrete').value) || assumptions.pierCosts.concrete;
            assumptions.pierCosts.steel = parseFloat(document.getElementById('pierCostSteel').value) || assumptions.pierCosts.steel;
            assumptions.pierCosts.helical = parseFloat(document.getElementById('pierCostHelical').value) || assumptions.pierCosts.helical;
            assumptions.permitCost = parseFloat(document.getElementById('permitCost').value) || assumptions.permitCost;
            assumptions.additionalCost = parseFloat(document.getElementById('additionalCost').value) || assumptions.additionalCost;
            assumptions.depthMultipliers.shallow = parseFloat(document.getElementById('depthShallow').value) || assumptions.depthMultipliers.shallow;
            assumptions.depthMultipliers.medium = parseFloat(document.getElementById('depthMedium').value) || assumptions.depthMultipliers.medium;
            assumptions.depthMultipliers.deep = parseFloat(document.getElementById('depthDeep').value) || assumptions.depthMultipliers.deep;
            assumptions.accessMultipliers.easy = parseFloat(document.getElementById('accessEasy').value) || assumptions.accessMultipliers.easy;
            assumptions.accessMultipliers.moderate = parseFloat(document.getElementById('accessModerate').value) || assumptions.accessMultipliers.moderate;
            assumptions.accessMultipliers.difficult = parseFloat(document.getElementById('accessDifficult').value) || assumptions.accessMultipliers.difficult;
            assumptions.slabPerimeterSpacing = parseFloat(document.getElementById('slabPerimeterSpacing').value) || assumptions.slabPerimeterSpacing;
            assumptions.slabInteriorDensity = parseFloat(document.getElementById('slabInteriorDensity').value) || assumptions.slabInteriorDensity;
            assumptions.slabBothInteriorDensity = parseFloat(document.getElementById('slabBothInteriorDensity').value) || assumptions.slabBothInteriorDensity;
            assumptions.crawlBasementDensity = parseFloat(document.getElementById('crawlBasementDensity').value) || assumptions.crawlBasementDensity;
            assumptions.severityMultipliers.light = parseFloat(document.getElementById('severityLight').value) || assumptions.severityMultipliers.light;
            assumptions.severityMultipliers.moderate = parseFloat(document.getElementById('severityModerate').value) || assumptions.severityMultipliers.moderate;
            assumptions.severityMultipliers.severe = parseFloat(document.getElementById('severitySevere').value) || assumptions.severityMultipliers.severe;
        }

        function showInputScreen() {
            updateAssumptions();
            document.getElementById('adminScreen').style.display = 'none';
            document.getElementById('summaryScreen').style.display = 'none';
            document.getElementById('inputScreen').style.display = 'block';
            document.getElementById('infoBox').classList.remove('active');
        }

        // Info box handling
        function showInfoBox(info) {
            const infoBox = document.getElementById('infoBox');
            infoBox.textContent = info;
            infoBox.classList.toggle('active', !!info);
        }

        function setupInfoEvents() {
            const inputs = document.querySelectorAll('select, input[type="number"]');
            inputs.forEach(input => {
                input.addEventListener('focus', () => {
                    showInfoBox(input.getAttribute('data-info'));
                });
                input.addEventListener('blur', () => {
                    showInfoBox('');
                });
            });
        }

        // Add event listeners
        document.getElementById('calculateBtn').addEventListener('click', calculateEstimate);
        document.getElementById('adminBtn').addEventListener('click', showAdminScreen);
        document.getElementById('returnBtn').addEventListener('click', showInputScreen);
        document.getElementById('returnBtnAdmin').addEventListener('click', showInputScreen);

        // Initialize info box events
        setupInfoEvents();
    </script>
</body>
</html>
